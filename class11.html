<!-- class11.html -->
<!DOCTYPE html>
<html>
<head>
  <title>Class 11 Tests</title>
  <link rel="stylesheet" href="studentclass.css">
  <script type="module" src="appwrite.js"></script>
  <style>
    .test-card {
      background: white;
      margin: 20px auto;
      padding: 20px;
      border-radius: 15px;
      max-width: 800px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    img, iframe { width: 100%; border-radius: 10px; margin-top: 10px; }
  </style>
</head>
<body>
  <h1 class="fixed-header">Class 11 - All Tests</h1>
  <div class="welcome-container">
    <button onclick="history.back()" class="cancel-btn" style="margin-bottom:20px;">Back</button>
    <div id="tests"></div>
  </div>

  <script type="module">
    import { getTestsForClass, storage, BUCKET_ID } from './appwrite.js';

    const testsDiv = document.getElementById('tests');

    async function loadTests() {
      const tests = await getTestsForClass("Class 11");
      
      if (tests.length === 0) {
        testsDiv.innerHTML = "<p>No tests uploaded yet.</p>";
        return;
      }

      const projectId = '690cbc750001ae465885';
      testsDiv.innerHTML = tests.map(test => {
        const url = `https://fra.cloud.appwrite.io/v1/storage/buckets/${BUCKET_ID}/files/${test.fileId}/view?project=${projectId}`;
        
        const isPDF = test.fileId.toLowerCase().includes('.pdf');
        
        return `
          <div class="test-card">
            <h2>${test.topic}</h2>
            <p><strong>Subject:</strong> ${test.subject}</p>
            <p><strong>Teacher:</strong> ${test.teacher}</p>
            <p><strong>Uploaded:</strong> ${new Date(test.uploadedAt).toLocaleDateString()}</p>
            ${isPDF 
              ? `<iframe src="${url}" height="600"></iframe>`
              : `<img src="${url}" loading="lazy">`
            }
            <a href="${url}" download class="confirm-btn" style="display:inline-block; margin-top:10px; padding:10px 20px;">
              Download
            </a>
          </div>
        `;
      }).join('');
    }

    loadTests().catch(err => {
      testsDiv.innerHTML = `<p style="color:red;">Error loading tests: ${err.message}</p>`;
    });
  </script>
</body>
</html>
