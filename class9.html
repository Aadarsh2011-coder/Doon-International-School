<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Class 9 Tests | Doon International School</title>
  <script type="module" src="../Landingpage/appwrite.js"></script>
<link rel="stylesheet" href="studentclass.css">

</head>

<body>
  <h1 class="fixed-header">Class 9 - All Tests</h1>

  <div class="welcome-container">
    <button onclick="history.back()" class="cancel-btn">‚Üê Back</button>
    <div id="tests"></div>
  </div>

  <script type="module">
    import { getTestsForClass, storage, BUCKET_ID } from './appwrite.js';

    const testsDiv = document.getElementById('tests');

    async function loadTests() {
      const tests = await getTestsForClass("Class 9");
      
      if (tests.length === 0) {
        testsDiv.innerHTML = "<p>No tests uploaded yet.</p>";
        return;
      }

      testsDiv.innerHTML = tests.map(test => {
        const url = `https://fra.cloud.appwrite.io/v1/storage/buckets/${BUCKET_ID}/files/${test.fileId}/view?project=690cbc750001ae465885`;
        const isPDF = test.fileId.endsWith('.pdf') || url.includes('.pdf');
        
        return `
          <div class="test-card">
            <h2>${test.topic}</h2>
            <p><strong>Subject:</strong> ${test.subject}</p>
            <p><strong>Teacher:</strong> ${test.teacher}</p>
            <p><strong>Uploaded:</strong> ${new Date(test.uploadedAt).toLocaleDateString()}</p>
            ${isPDF 
              ? `<iframe src="${url}" height="500"></iframe>`
              : `<img src="${url}" loading="lazy">`
            }
            <a href="${url}" download class="confirm-btn">
              üì• Download
            </a>
          </div>
        `;
      }).join('');
    }

    loadTests();
  </script>
</body>
</html>
